<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AITU | Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… R&D</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --main-color: #ff3e3e; --bg-dark: #0f0f0f; --card-bg: #1a1a1a; --accent: #00f2ff; }
        body { background: var(--bg-dark); color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 15px; }
        .wrapper { max-width: 550px; margin: auto; }
        
        /* Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø·ÙˆØ± */
        .p10-monitor { background: #000; border: 3px solid #333; border-radius: 12px; padding: 10px; margin-bottom: 25px; box-shadow: 0 0 15px rgba(255, 62, 62, 0.3); }
        #canvasSim { width: 100%; border-radius: 4px; background: #050505; }
        .monitor-info { display: flex; justify-content: space-between; font-size: 11px; color: var(--main-color); margin-top: 5px; font-weight: bold; }

        .control-card { background: var(--card-bg); padding: 20px; border-radius: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.5); border: 1px solid #2a2a2a; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 20px; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-size: 0.9rem; color: #bbb; }
        input, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #333; background: #111; color: white; box-sizing: border-box; transition: 0.3s; }
        input:focus { border-color: var(--accent); box-shadow: 0 0 8px rgba(0, 242, 255, 0.2); outline: none; }
        
        .btn-sync { background: linear-gradient(45deg, var(--main-color), #b30000); color: white; width: 100%; padding: 16px; border: none; border-radius: 12px; font-weight: bold; font-size: 1.1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 12px; }
        .btn-sync:hover { filter: brightness(1.2); transform: translateY(-2px); }
        
        .badge { background: #333; padding: 4px 10px; border-radius: 20px; font-size: 12px; color: var(--accent); border: 1px solid var(--accent); }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="p10-monitor">
        <canvas id="canvasSim"></canvas>
        <div class="monitor-info">
            <span><i class="fas fa-microchip"></i> ESP8266 Active</span>
            <span id="displayingNow">AITU / R&D Mode</span>
        </div>
    </div>

    <div class="control-card">
        <div class="header">
            <h2 style="margin:0; font-size: 1.3rem;">ğŸš€ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø°ÙƒÙŠ</h2>
            <div class="badge">Amir Gamal</div>
        </div>

        <div class="form-group">
            <label><i class="fas fa-expand-arrows-alt"></i> Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø´Ø§Ø´Ø© (Pixel):</label>
            <div style="display:flex; gap:10px;">
                <input type="number" id="wW" value="64" oninput="updatePreview()">
                <input type="number" id="hH" value="32" oninput="updatePreview()">
            </div>
        </div>

        <div class="form-group">
            <label><i class="fas fa-exchange-alt"></i> ÙˆÙ‚Øª Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† AITU Ùˆ R&D:</label>
            <input type="number" id="switchT" value="5" min="1">
        </div>

        <div class="form-group">
            <label><i class="fas fa-sun"></i> Ù…Ø³ØªÙˆÙ‰ Ø³Ø·ÙˆØ¹ Ø§Ù„Ø´Ø§Ø´Ø©:</label>
            <input type="range" id="brVal" min="0" max="255" value="150">
        </div>

        <div class="form-group">
            <label><i class="fas fa-history"></i> ÙˆØ¶Ø¹ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®:</label>
            <select id="dateMode">
                <option value="0">Ù‡Ø¬Ø±ÙŠ (ÙŠØ³Ø§Ø±) | Ù…ÙŠÙ„Ø§Ø¯ÙŠ (ÙŠÙ…ÙŠÙ†)</option>
                <option value="1">Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</option>
            </select>
        </div>

        <button class="btn-sync" onclick="sendToESP()">
            <i class="fas fa-paper-plane"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¢Ù†
        </button>
    </div>
</div>

<script>
    const canvas = document.getElementById('canvasSim');
    const ctx = canvas.getContext('2d');
    let toggle = true;

    function updatePreview() {
        canvas.width = document.getElementById('wW').value * 4;
        canvas.height = document.getElementById('hH').value * 4;
        drawPreview();
    }

    function drawPreview() {
        ctx.fillStyle = "#000";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // Ø±Ø³Ù… Ø§Ù„Ù†Ù‚Ø§Ø· (ØªØ£Ø«ÙŠØ± P10)
        ctx.fillStyle = "#111";
        for(let x=0; x<canvas.width; x+=4) {
            for(let y=0; y<canvas.height; y+=4) {
                ctx.beginPath(); ctx.arc(x+2, y+2, 1, 0, Math.PI*2); ctx.fill();
            }
        }

        const now = new Date();
        ctx.fillStyle = "#ff3e3e";
        
        // 1. Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® (Ø§Ù„Ù‡Ø¬Ø±ÙŠ ÙŠØ³Ø§Ø± ÙˆØ§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ ÙŠÙ…ÙŠÙ† ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª)
        ctx.font = "12px monospace";
        ctx.textAlign = "left";
        ctx.fillText("17/08/1447", 10, 20); // Ù‡Ø¬Ø±ÙŠ
        ctx.textAlign = "right";
        ctx.fillText(now.toLocaleDateString('en-GB'), canvas.width - 10, 20); // Ù…ÙŠÙ„Ø§Ø¯ÙŠ

        // 2. Ø§Ù„Ø³Ø§Ø¹Ø© (Ù…Ù†ØªØµÙ)
        ctx.textAlign = "center";
        ctx.font = "bold 28px Courier New";
        ctx.fillText(now.toLocaleTimeString('en-US', {hour12: true}), canvas.width/2, canvas.height/2 + 10);

        // 3. Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªØ¨Ø§Ø¯Ù„Ø©
        ctx.fillStyle = "#00f2ff";
        ctx.font = "bold 18px Arial";
        ctx.fillText(toggle ? "AITU" : "R&D", canvas.width/2, canvas.height - 15);
    }

    setInterval(() => { toggle = !toggle; drawPreview(); }, 3000);
    setInterval(drawPreview, 1000);

    function sendToESP() {
        const d = new Date();
        const url = `/update?w=${document.getElementById('wW').value}&h=${document.getElementById('hH').value}&time=${document.getElementById('switchT').value}&br=${document.getElementById('brVal').value}&h=${d.getHours()}&m=${d.getMinutes()}&s=${d.getSeconds()}&day=${d.getDate()}&mon=${d.getMonth()+1}&yr=${d.getFullYear()}&tA=AITU&tB=R&D`;
        
        fetch(url).then(() => alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù„Ù€ AITU Ø¨Ù†Ø¬Ø§Ø­!"));
    }

    window.onload = updatePreview;
</script>
</body>
</html>
